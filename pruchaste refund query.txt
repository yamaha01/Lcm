select ejn.invoice_no as InvoiceNo, ejn.ins_dt as InvDate, ejn.airline_cd as AirCd, am.airline_nm as VendorName, nq.amount as InvoiceAmount, nq.total_amt as PrimeOwing, cbc.AP as BaseTaxOwing, ejn.ins_dt as DueDate, (nq.total_amt - cbc.AP)`SvcIncome` from (select ej.job_no, ej.invoice_no, ej.job_dt, ej.cust_cd, ag.airline_cd, ag.ins_dt, ej.pod_final from clx_entry_job ej, clx_aga01 ag where ag.job_no = ej.job_no and ag.slip_type = 'I' and ag.ins_dt BETWEEN '2014/01/01' AND '2014/04/30') ejn inner join (SELECT seq, cbp.job_no, freight_cd, cust_kind, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, SUM(`amt_bill`)`amount`, SUM(qty * amt_bill)`total_amt` FROM lcm.clx_bill_prepaid cbp group by job_no) nq on ejn.job_no = nq.job_no inner join clx_cust_mst cm on ejn.cust_cd = cm.cust_cd inner join (SELECT airmst.airline_cd, airline_nm FROM clx_air_mst airmst) am on am.airline_cd = ejn.airline_cd inner join (SELECT seq, job_no, freight_cd, cust_kind, cust_cd, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, amt_bill, remark, invoice_no, ins_dt, ins_id, upd_dt, upd_id, del_id, del_dt, SUM(qty * amt_bill)`AP` FROM lcm.clx_bill_cost where seq is null group by job_no) cbc on ejn.job_no = cbc.job_no

SELECT job_no, job_dt, invoice_no, airline_cd, cust_cd, awb_no, mawb_no, sra_no, service_type, actm_no, pod_final, d1_pol, d1_air_fl1, d1_air_fl2, d1_date, d1_air_fd1, d1_air_fd2, d2_pol, d2_air_fl1, d2_air_fl2, d2_date, d2_air_fd1, d2_air_fd2, d3_pol, d3_air_fl1, d3_air_fl2, d3_date, d3_air_fd1, d3_air_fd2, d4_pol, d4_air_fl1, d4_air_fl2, d4_date, d4_air_fd1, d4_air_fd2, d5_pol, d5_air_fl1, d5_air_fl2, d5_date, d5_air_fd1, d5_air_fd2, marketing_cd, agent_cd, shipper_cd, cnee_cd, comodity_cd, pkgs, pkgs_type, gwt, cwt, cbm, sell_frt, cost_frt, remarks, fix_yn, freight_term, ins_dt, ins_id, upd_dt, upd_id, del_id, del_dt, schm_sell, schm_buy 
FROM lcm.clx_entry_job where remarks is not null and job_dt BETWEEN '2014/04/01' AND '2014/06/31'

//this is running ok but with warning
select distinct ejn.invoice_no as InvoiceNo, ejn.ins_dt as InvDate, ejn.airline_cd as AirCd, am.airline_nm as VendorName, ejn.cwt as Toonage, nq.total_amt as PrimeOwing, cbc.AP as BaseTaxOwing, ejn.ins_dt as DueDate, (nq.total_amt - cbc.AP)`SvcIncome` from (select ej.job_no, ej.invoice_no, ej.job_dt, ej.cust_cd, ej.cwt, ag.airline_cd, ag.ins_dt, ej.pod_final, ej.remarks from clx_entry_job ej, clx_aga01 ag where ag.job_no = ej.job_no and ag.slip_type = 'I' and ag.ins_dt BETWEEN '2014/01/01' AND '2014/04/30') ejn left join (SELECT seq, cbp.job_no, freight_cd, cust_kind, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, SUM(`amt_bill`)`amount`, SUM(qty * amt_bill)`total_amt` FROM lcm.clx_bill_prepaid cbp group by job_no) nq on ejn.job_no = nq.job_no inner join clx_cust_mst cm on ejn.cust_cd = cm.cust_cd inner join (SELECT airmst.airline_cd, airline_nm FROM clx_air_mst airmst) am on am.airline_cd = ejn.airline_cd inner join (SELECT job_no, freight_cd, cust_kind, cust_cd, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, amt_bill, remark, invoice_no, ins_dt, ins_id, upd_dt, upd_id, del_id, del_dt, SUM(qty * amt_bill)`AP` FROM lcm.clx_bill_cost where freight_cd != 'ZF' group by job_no) cbc on ejn.job_no = cbc.job_no left join (SELECT cbcr.freight_cd, cbcr.job_no, cbcr.qty, cbcr.amt_bill, SUM(qty * amt_bill)`Refund` FROM lcm.clx_bill_cost cbcr where cbcr.freight_cd = 'ZF' group by cbcr.job_no) clcbcr on ejn.job_no = clcbcr.job_no 

select ej1.job_no, nq.total_amt, ej1.remarks from (select ej.remarks, ej.job_no from lcm.clx_entry_job ej where ej.remarks is not null) ej1 left join (SELECT seq, job_no, qty, amt_bill, SUM(qty * amt_bill)`Refund` FROM lcm.clx_bill_cost c where c.seq is not null) c1 on ej1.job_no = c1.job_no inner join (SELECT seq, cbp.job_no, freight_cd, cust_kind, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, SUM(`amt_bill`)`amount`, SUM(qty * amt_bill)`total_amt` FROM lcm.clx_bill_prepaid cbp group by job_no) nq on ej1.job_no = nq.job_no

"select ejn.invoice_no as InvoiceNo, ejn.ins_dt as InvDate, ejn.airline_cd as AirCd, " &
            "am.airline_nm as VendorName, nq.amount as InvoiceAmount, nq.total_amt as PrimeOwing, cbc.AP as BaseTaxOwing, " &
            "ejn.ins_dt as DueDate, (nq.total_amt - cbc.AP)`SvcIncome` " &
            "from (select ej.job_no, ej.invoice_no, ej.job_dt, ej.cust_cd, ag.airline_cd, ag.ins_dt, ej.pod_final from clx_entry_job ej, clx_aga01 ag " &
            "where ag.job_no = ej.job_no and ag.slip_type = 'I' and ag.ins_dt BETWEEN '" & formatStartDate & "' AND '" & formatEndDate & "') ejn " &
            "inner join (SELECT seq, cbp.job_no, freight_cd, cust_kind, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, SUM(`amt_bill`)`amount`, SUM(qty * amt_bill)`total_amt` FROM lcm.clx_bill_prepaid cbp group by job_no) nq on ejn.job_no = nq.job_no " &
            "inner join clx_cust_mst cm on ejn.cust_cd = cm.cust_cd " &
            "inner join (SELECT airmst.airline_cd, airline_nm FROM clx_air_mst airmst) am on am.airline_cd = ejn.airline_cd " &
            "inner join (SELECT seq, job_no, freight_cd, cust_kind, cust_cd, bill_dt, curr_cd, tax_cd, amt_tax, qty, exchange_rate, amt_bill, remark, invoice_no, ins_dt, ins_id, upd_dt, upd_id, del_id, del_dt, SUM(qty * amt_bill)`AP` " &
            "FROM lcm.clx_bill_cost group by job_no) cbc on ejn.job_no = cbc.job_no " & getInvConditions()
